#TYPEDEF OfBoolean
  packagename = ofboolean
  PackageName = OfBoolean
  <E> = 
  ArrayType = boolean
  Consumer = BooleanConsumer
  BoxedType = Boolean
  exposedType = boolean
  castToDouble = TypeUtil.castToDouble
  castToFloat = TypeUtil.castToFloat
  castToLong = TypeUtil.castToLong
  castToInt = (int)TypeUtil.castToByte
  castToShort = (short)TypeUtil.castToByte
  castToChar = TypeUtil.castToChar
  castToByte = TypeUtil.castToByte
  BoxedArrayType = Boolean
  queryParameterType = boolean
  popMethod = popBoolean
#ENDDEF
#TYPEDEF OfByte
  packagename = ofbyte
  PackageName = OfByte
  <E> = 
  ArrayType = byte
  Consumer = ByteConsumer
  BoxedType = Byte
  exposedType = byte
  castToDouble = (double)
  castToFloat = (float)
  castToLong =(long)
  castToInt = (int)
  castToShort = (short)
  castToByte = (byte)
  BoxedArrayType = Byte
  queryParameterType = int
  popMethod = popByte
#ENDDEF
#TYPEDEF OfChar
  packagename = ofchar
  PackageName = OfChar
  <E> = 
  ArrayType = char
  Consumer = CharConsumer
  BoxedType = Character
  exposedType = char
  castToDouble = (double)
  castToFloat = (float)
  castToLong =(long)
  castToInt = (int)
  castToChar = (char)
  BoxedArrayType = Character
  queryParameterType = int
  popMethod = popChar
#ENDDEF
#TYPEDEF OfShort
  packagename = ofshort
  PackageName = OfShort
  <E> = 
  ArrayType = short
  Consumer = ShortConsumer
  BoxedType = Short
  exposedType = short
  castToDouble = (double)
  castToFloat = (float)
  castToLong =(long)
  castToInt = (int)
  castToShort = (short)
  BoxedArrayType = Short
  queryParameterType = int
  popMethod = popShort
#ENDDEF
#TYPEDEF OfInt
  packagename = ofint
  PackageName = OfInt
  <E> = 
  ArrayType = int
  Consumer = IntConsumer
  BoxedType = Integer
  exposedType = int
  castToDouble = (double)
  castToFloat = (float)
  castToLong =(long)
  castToInt = (int)
  BoxedArrayType = Integer
  queryParameterType = int
  popMethod = popInt
#ENDDEF
#TYPEDEF OfLong
  packagename = oflong
  PackageName = OfLong
  <E> = 
  ArrayType = long
  Consumer = LongConsumer
  BoxedType = Long
  exposedType = long
  castToDouble = (double)
  castToFloat = (float)
  castToLong =(long)
  BoxedArrayType = Long
  queryParameterType = long
  popMethod = popLong
#ENDDEF
#TYPEDEF OfFloat
  packagename = offloat
  PackageName = OfFloat
  <E> = 
  ArrayType = float
  Consumer = FloatConsumer
  BoxedType = Float
  exposedType = float
  castToDouble = (double)
  castToFloat = (float)
  BoxedArrayType = Float
  queryParameterType = int
  convertToBits = Float.floatToRawIntBits
  popMethod = popFloat
#ENDDEF
#TYPEDEF OfDouble
  packagename = ofdouble
  PackageName = OfDouble
  <E> = 
  ArrayType = double
  Consumer = DoubleConsumer
  BoxedType = Double
  exposedType = double
  castToDouble = (double)
  BoxedArrayType = Double
  queryParameterType = long
  convertToBits = Double.doubleToRawLongBits
  popMethod = popDouble
#ENDDEF
#TYPEDEF OfRef
  packagename = ofref
  PackageName = OfRef
  <E> = <E>
  ArrayType = Object
  Consumer = Consumer<? super E>
  BoxedType = E
  exposedType = E
  BoxedArrayType = Object
#ENDDEF
package omni.impl.seq.arr.$packagename$;
import omni.api.OmniStack;
import omni.api.OmniIterator;
import omni.util.ArrCopy;
import omni.impl.seq.arr.ArrSeqUtil;
#IF OfDouble,OfLong,OfInt
import java.util.function.$Consumer$;
#ELSEIF OfRef
import java.util.Objects;
import java.util.function.Predicate;
import java.util.function.Consumer;
#ELSE
import omni.function.$Consumer$;
#ENDIF
#IF OfBoolean
import omni.util.TypeUtil;
#ENDIF
import java.util.NoSuchElementException;
import omni.impl.CheckedCollection;
public class CheckedStack$<E>$ extends AbstractSeq.Checked$<E>$ implements OmniStack.$PackageName$$<E>$
{
  CheckedStack()
  {
    super();
  }
  CheckedStack(int capacity)
  {
    super(capacity);
  }
  private CheckedStack(int size,$ArrayType$[] arr)
  {
    super(size,arr);
  }
  @Override
  public Object clone()
  {
    final $ArrayType$[] arr;
    final int size;
    if((size=this.size)!=0)
    {
      ArrCopy.uncheckedCopy(this.arr,0,arr=new $ArrayType$[size],0,size);
    }
    else
    {
      arr=null;
    }
    return new CheckedStack$<E>$(size,arr);
  }
  @Override
  public boolean equals(Object val)
  {
    //TODO
    return false;
  }
  @Override
  public OmniIterator.$PackageName$$<E>$ iterator()
  {
    //TODO
    return null;
  }
#MACRODEF Poll(retType,Suffix,emptyVal,cast)
  @Override
  public retType pollSuffix()
  {
    final int size;
    if((size=this.size)!=0)
    {
      ++modCount;
      return cast(super.uncheckedPop(size-1));
    }
    return emptyVal;
  }
#ENDDEF
#MACRO Poll(\$BoxedType\$,,null,(\$BoxedType\$))
  @Override
  public $BoxedType$ pop()
  {
    final int size;
    if((size=this.size)!=0)
    {
      ++modCount;
      return super.uncheckedPop(size-1);
    }
    throw new NoSuchElementException();
  }
#MACRODEF arrcopyMethod(arrType)
  @Override
  void uncheckedCopyInto(arrType[] arr,int size)
  {
    ArrCopy.uncheckedReverseCopy(this.arr,0,arr,0,size);
  }
#ENDDEF
#MACRO arrcopyMethod(\$BoxedArrayType\$)
  @Override
  void uncheckedForEach(int size,$Consumer$ action)
  {
    final int modCount=this.modCount;
    try
    {
      ArrSeqUtil.uncheckedReverseForEach(arr,0,size,action);
    }
    finally
    {
      CheckedCollection.checkModCount(modCount,this.modCount);
    }
  }
  @Override
  int uncheckedHashCode(int size)
  {
#IF OfRef
    final int modCount=this.modCount;
    try
    {
#ENDIF
      return ArrSeqUtil.reverseHashCode(arr,0,size);
#IF OfRef
    }
    finally
    {
      CheckedCollection.checkModCount(modCount,this.modCount);
    }
#ENDIF
  }
  @Override
  void uncheckedToString(int size,StringBuilder builder)
  {
#IF OfRef
    final int modCount=this.modCount;
    try
    {
#ENDIF
      ArrSeqUtil.reverseToString(arr,0,size,builder);
#IF OfRef
    }
    finally
    {
      CheckedCollection.checkModCount(modCount,this.modCount);
    }
#ENDIF
  }
  @Override
  public void push($BoxedType$ val)
  {
    ++modCount;
    super.push(($exposedType$)val);
  }
#MACRODEF UncheckedRemoveVal(indexTest,Suffix,methodParams)
   @Override
   boolean uncheckedremoveValSuffix(methodParams)
   {
     final var arr=this.arr;
     int index;
     for(index=--size;indexTest(arr[index]);--index)
     {
       if(index==0)
       {
         return false;
       }
     }
     ++modCount;
     ArrSeqUtil.eraseIndexHelper(arr,index,size);
     this.size=size;
     return true;
   }
#ENDDEF
#IF OfRef
  @Override
  public int search(Object val)
  {
    final int size;
    if((size=this.size)!=0)
    {
      if(val!=null)
      {
        final int modCount=this.modCount;
        try
        {
          return ArrSeqUtil.uncheckedsearch(arr,size,val::equals);
        }
        finally
        {
          CheckedCollection.checkModCount(modCount,this.modCount);
        }
      }
      return ArrSeqUtil.uncheckedsearch(arr,size,Objects::isNull);
    }
    return -1;
  }
  #MACRO UncheckedRemoveVal(!pred.test,,int size\,Predicate<Object> pred)
  @Override
  boolean uncheckedremoveValNonNull(int size,Object nonNull){
    final var arr=this.arr;
    final int modCount=this.modCount;
    int index;
    try
    {
      for(index=--size;!nonNull.equals(arr[index]);--index){
        if(index==0){ return false; }
      }
    }
    finally
    {
      CheckedCollection.checkModCount(modCount,this.modCount);
    }
    this.modCount=modCount+1;
    ArrSeqUtil.eraseIndexHelper(arr,index,size);
    this.size=size;
    return true;
  }
#ELSE
  @Override
  public $exposedType$ $popMethod$()
  {
    final int size;
    if((size=this.size)!=0)
    {
      ++modCount;
      return ($exposedType$)super.uncheckedPop(size-1);
    }
    throw new NoSuchElementException();
  }
  #MACRO arrcopyMethod(Object)
  #IF OfDouble,OfFloat
    #MACRO UncheckedRemoveVal(0!=,0,int size)
    #MACRO UncheckedRemoveVal(bits!=\$convertToBits\$,Bits,int size\,\$queryParameterType\$ bits)
    #MACRO UncheckedRemoveVal(!\$BoxedType\$.isNaN,NaN,int size)
  #ELSE
    #MACRO Poll(long,Long,Long.MIN_VALUE,\$castToLong\$)
    #MACRO arrcopyMethod(long)
    #MACRO UncheckedRemoveVal(val!=,,int size\,\$queryParameterType\$ val)
    #IF OfInt,OfShort,OfChar,OfByte,OfBoolean
      #MACRO Poll(int,Int,Integer.MIN_VALUE,\$castToInt\$)
      #MACRO arrcopyMethod(int)
      #IF OfShort,OfByte,OfBoolean
        #MACRO Poll(short,Short,Short.MIN_VALUE,\$castToShort\$)
        #MACRO arrcopyMethod(short)
        #IF OfByte,OfBoolean
          #MACRO Poll(byte,Byte,Byte.MIN_VALUE,\$castToByte\$)
          #MACRO arrcopyMethod(byte)
          #IF OfBoolean
            #MACRO Poll(boolean,Boolean,false,(boolean))
            #MACRO arrcopyMethod(boolean)
          #ENDIF
        #ENDIF
      #ENDIF
      #IF OfChar,OfBoolean
        #MACRO Poll(char,Char,Character.MIN_VALUE,\$castToChar\$)
        #MACRO arrcopyMethod(char)
      #ENDIF
    #ENDIF
  #ENDIF
  #MACRO Poll(double,Double,Double.NaN,\$castToDouble\$)
  #MACRO arrcopyMethod(double)
  #IF OfFloat,OfLong,OfInt,OfShort,OfChar,OfByte,OfBoolean
    #MACRO Poll(float,Float,Float.NaN,\$castToFloat\$)
    #MACRO arrcopyMethod(float)
  #ENDIF
#ENDIF
}
